<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Content Admin</title>
    <script>
      // Prevent Decap from auto-booting before <body> exists
      window.CMS_MANUAL_INIT = true;
    </script>
    <script src="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Roboto Mono', monospace; }
    </style>
  </head>
  <body>
    <!-- Explicitly initialize CMS and point to the correct config path -->
    <script>
      (function() {
        function init() {
          if (!window.CMS) {
            setTimeout(init, 50);
            return;
          }
          var configPath = '/admin/config.yml';
          // Inject runtime app_id from environment if exposed via NEXT_PUBLIC_GITHUB_CLIENT_ID
          var runtimeAppId = typeof window !== 'undefined' && window._env_ && window._env_.NEXT_PUBLIC_GITHUB_CLIENT_ID;
          var cfg = { load_config_file: true, config: configPath };
          if (runtimeAppId) {
            cfg.config = {
              backend: {
                name: 'github',
                repo: 'Parsabz/parsa-portfolio',
                branch: 'main',
                base_url: 'https://parsaw.netlify.app',
                auth_endpoint: '/api/decap/oauth/authorize',
                site_domain: 'https://parsaw.netlify.app',
                app_id: runtimeAppId
              },
              media_folder: 'public/uploads',
              public_folder: '/uploads'
            };
          }
          window.CMS.init(cfg);
        }
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          init();
        } else {
          window.addEventListener('DOMContentLoaded', init);
        }
      })();
    </script>
  </body>
</html>



